---
title: "Open Science for a better World"
subtitle: "An introduction to the main tools"
author: 
  - "Fabio CRUZ"
  - "Giovanny Arbelaez"
  - "Mauricio Camargo"
institute: "ERPI"
date: "`r format(Sys.Date(), '%B %e, %Y')`"
#output: powerpoint_presentation
output:
  xaringan::moon_reader:
    css: ["default", "css/my-theme.css", "css/my-fonts.css"]
    #css: ["assets/xaringan-themer.css"]
    seal: TRUE
    nature:
      slideNumberFormat: "%current%/%total%" 
      highlightStyle: solarized-light
      highlightLanguage: ["r", "css", "yaml"]      
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
      navigation:
        scroll: false # disable slide transitions by scrolling
always_allow_html: true
---

```{r packages, echo = FALSE, message=FALSE, warning=FALSE}
# Source
#source("xaringan-themer.R")

# load packages ----------------------------------------------------------------
library(tidyverse)
library(xaringanExtra)
library(xaringanthemer)
library(fontawesome)
library(here)
library(countdown)
library(ymlthis)
library(tidyverse)
library(ggthemes)
library(icons) # remotes::install_github("mitchelloharawild/icons")
library(icon)
library(emoji)
library(palmerpenguins)
library(fontawesome)

options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.path = 'assets/chunks/', cache.path = "assets/cache/", 
                      collapse = TRUE,
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  fig.align = 'center',
  cache = FALSE,
  echo = FALSE,
  message = FALSE, 
  warning = FALSE,
  fig.show = TRUE,
  hiline = TRUE,
  include = TRUE
)

# Link for the Figures
URL = c('https://raw.githubusercontent.com/fabbiocrux/Figures/main/')

#library(xaringanBuilder)
#build_pdf("index.Rmd")

# xaringanExtra
xaringanExtra::use_panelset()

#xaringanExtra::use_share_again()
xaringanExtra::use_tachyons()
xaringanExtra::use_tile_view()
xaringanExtra::use_webcam()
xaringanExtra::use_fit_screen()
xaringanExtra::use_extra_styles(hover_code_line = TRUE, mute_unhighlighted_code = TRUE)
xaringanExtra::use_share_again()
xaringanExtra::use_panelset()


```

---

# Learning goals

* Understand the process of create reproducible documents
* Have a first insight in the data visualization practices using datasets
* Experience the diversity of options that open practices offers to communicate your results. 


---

## Assignments for ARCHE Plateform

After that, several questions need to be answered at the end of the tutorial. 

A pdf document with the results  are going to be upload to the ARCHE Platform to evaluate the comprehension of the module.


---

# Recommended setup 

1. Sign up for free version: https://rstudio.cloud/

2. Use you UL account!

3. Voila!, C'est bon


---

background-image: url("http://assets.aims.fao.org.s3-eu-west-1.amazonaws.com/public/figures/Open%20Science%20Monitor.jpg")
background-position: 95% 50%
background-size: 50%
class: left middle

.pull-left[
*"Open Science refers to ongoing changes <br>in the way research is conducted: 
for scientists themselves, through increasing the use of <br> 
open access scientific publishing and open data, <br>
and for the public, through increasing their understanding of and participation in science... <br>
Open Science is one of three priority areas for European research, science and innovation policy,"- [RAND Corporation](http://aims.fao.org/activity/blog/open-science-monitor-access-data-and-trends-open-science).*
]

---

# The paper pipeline

```{r Fig_open-science, }
knitr::include_graphics("figures/Article-pipeline-1.png")
```

---

## Music Vs. Research

.pull-left[
```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='80%'}
knitr::include_graphics("figures/Musica.jpeg")
```

]
.pull-right[
```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='100%'}
knitr::include_graphics("figures/Paper.png")
```

]


---

## Music Vs. Research

.pull-left[
```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='100%'}
knitr::include_graphics("figures/excel-chaos.jpg")
```

]
.pull-right[
```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='100%'}
knitr::include_graphics("figures/Paper.png")
```
]


---

# The document pipeline

```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='90%'}
knitr::include_graphics("figures/Article-pipeline-2.png")
```


How to describe in detail this section for Research & Industry purposes

---

# Reproducibility and Replicability

.pull-left[
**Reproducibility**: 

Refers to the ability of a researcher to duplicate the results of a prior study using the same materials as were used by the original researcher (Goodman, Fanelli, and Ioannidis 2016).

- Focuses on the validity of the data analysis
- "Can we trust this analysis?"

]

.pull-rigth[
**Replicability:** 

This is the act of repeating an entire study, independently of the original investigator without the use of original data (but generally using the same methods).

- Important for policymakers and regulatory decisions

]


.footnote.small[
Goodman, Steven N., Daniele Fanelli, and John P. A. Ioannidis. 2016. “What Does Research Reproducibility Mean?” Science Translational Medicine 8 (341): 341ps12–341ps12. https://doi.org/10.1126/scitranslmed.aaf5027.
]

---


## Why do we need Reproducible Research?

- Avoid misconduct such as fraudulent data and plagiarism
- Data-intensive research (e.g Big data research)
- Distributed research


<img height="270px" class="plain" src="figures/Problem-1.png">
<img height="250px" class="plain" src="figures/Problem-3.png">
<img height="250px" class="plain" src="figures/Problem-2.png">

---
background-image: url("https://figures-na.ssl-figures-amazon.com/figures/I/41KSVC8Q2JL.jpg")
background-position: 90% 50%
background-size: 30%


## Reproducibility concepts

Two key elements: 

- **Literate programming for enabling reproducibilty**
- Version control for enhancing transparency

*...for significantly better documentation of programs, <br>and that we can best achieve <br>this by considering programs to be works of literature.*


.footnote[
D. E. Knuth, Literate Programming, The Computer Journal, Volume 27, Issue 2, 1984, Pages 97–111, https://doi.org/10.1093/comjnl/27.2.97
]

---

## Literate programming for enabling reproducibilty

*Literate programming refers to the use of a computing environment for authoring documents that contain a mix of natural (eg. English) and computer (eg. R) languages (Schulte et al. 2012)*

```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='80%'}
knitr::include_graphics("figures/Word-excel.jpg")
```


.footnote[ Schulte, Eric, Dan Davison, Thomas Dye, and Carsten Dominik. 2012. “A Multi-Language Computing Environment for Literate Programming and Reproducible Research.” Journal of Statistical Software 46 (1): 1–24. https://doi.org/10.18637/jss.v046.i03.]

---

## Literate programming for enabling reproducibilty

*Literate programming refers to the use of a computing environment for authoring documents that contain a mix of natural (eg. English) and computer (eg. R) languages (Schulte et al. 2012)*

```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='70%'}
knitr::include_graphics("figures/rstudio.png")
```

---
## What is R/RStudio?

- R is a statistical programming language
- RStudio is a convenient interface for R (an integrated development environment, IDE)


.footnote[ Schulte, Eric, Dan Davison, Thomas Dye, and Carsten Dominik. 2012. “A Multi-Language Computing Environment for Literate Programming and Reproducible Research.” Journal of Statistical Software 46 (1): 1–24. https://doi.org/10.18637/jss.v046.i03.]


---
exclude: true

## Rmarkdown

```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='70%'}
knitr::include_graphics("figures/Rmarkdown.png")
```

- [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)

---

exclude: true

## Github

1. Open source
2. Control version

```{r, include=TRUE, fig.align='center', cache=TRUE, out.width='50%'}
knitr::include_graphics("https://github.githubassets.com/figures/modules/logos_page/GitHub-Mark.png")
```


---

class: middle

#  What is Data Visualization?

- are graphical representations of data
- use different colors, shapes, and the coordinate system to summarize data
- tell a story
- are useful for exploring data



---

class: middle

## For example

[Coronavirus Pandemic (COVID-19)](https://ourworldindata.org/coronavirus)

[How LGBTQ+ hate crime is committed by young people against young people](https://www.bbc.com/news/uk-46543874)

[Why Time Flies](https://maximiliankiener.com/digitalprojects/time/)

[Mandatory Paid Vacation](https://www.instagram.com/p/CE1kpM5FhWR/?utm_source=ig_web_copy_link)

[Why are K-pop groups so big?](https://pudding.cool/2020/10/kpop/)





---

# Summary

- Reproducible research is important as a **minimum standard**, particularly for studies that are difficult to replicate
- Infrastructure is needed for creating and distributing reproducible documents, beyond what is currently available
- There is a growing number of tools for creating reproducible documents

**Some challengues**

- It is not the solution for everyone.

---
class: middle

# Main goal of the workshop

 .Large[Zero to Hero for a reproducible document ]

.center[
##  https://rstudio.cloud/project/2139211
]

---

class: center, middle

# Thanks!

---


---

# Basics to data visualization

1. Package {ggplot2}
1. Basic structure for graphics

```{r, echo=TRUE, eval=FALSE}
ggplot(data = <DATA>) + 
  aes(x = <X>, y = <Y>) + 
   <GEOM_FUNCTION>() 
```


1. Aesthetic parameters `aes()`
1. Geometrical Objects `geom_XX()`

---

# Tidyverse

.pull-left[
- **Ordocosme** in `r emo::ji("fr")` with *Tidy* for "bien rangé" and *verse*_* for "universe"
- A collection of R `r emo::ji("package")` developed by [Hadley Wickham](https://scholar.google.fr/citations?user=YA43PbsAAAAJ&hl=en&oi=ao) and others at Rstudio

>Tidyverse is a .bg-green[language for solving data science challenges with R code]. 
Its primary goal is to facilitate a conversation between a human and a computer about data. 
Less abstractly, the tidyverse is a collection of R packages that share a high-level design philosophy and low-level grammar and data structures, so that learning one package makes it easier to
learn the next.
]

.pull-right[
```{r , out.width = "100%", fig.align="center"}
knitr::include_graphics("assets/img/wickham_president.jpg")
```
]



.footnote[
Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M. Welcome to the Tidyverse. Journal of open source software. 2019 Nov 21;4(43):1686.
]


---

# Tidyverse

* "A framework for managing data that aims at making the cleaning and preparing steps [muuuuuuuch] easier" (Julien Barnier).

* Main characteristics of a tidy dataset:
    - each variable is a column
    - each observation is a raw
    - each value is in a different cell

```{r echo=FALSE, out.width = "80%", fig.align="center"}
knitr::include_graphics("assets/img/tidydata.png")
```


---

# **Tidyverse** is a collection of R `r emo::ji("package")`

* .bg-green[[`ggplot2` - visualising stuff](https://ggplot2.tidyverse.org/)]

* [`dplyr`, `tidyr` - data manipulation](https://dplyr.tidyverse.org/)

* `purrr` - advanced programming

* [`readr` - import data](https://readr.tidyverse.org/)

* [`tibble` - improved data.frame format](https://tibble.tidyverse.org/)

* [`forcats` - working w/ factors](https://forcats.tidyverse.org/)

* [`stringr` - working w/ chain of characters](https://stringr.tidyverse.org/)


---
class: middle


# Workflow in data science

```{r, echo=FALSE, out.width = '100%', fig.align="center"}
knitr::include_graphics("assets/img/data-science-workflow.png")
```

---

class: middle

# Workflow in data science, with **Tidyverse**

```{r, echo=FALSE, out.width = '90%', fig.align="center"}
knitr::include_graphics("assets/img/01_tidyverse_data_science.png")
```

---

background-image: url(https://github.com/rstudio/hex-stickers/raw/master/SVG/tidyverse.svg?sanitize=true)
background-size: 100px
background-position: 90% 3%

# Load [tidyverse](www.tidyverse.org) `r emo::ji("package")`

```{r}
#install.packages("tidyverse")
library(tidyverse)
```


---

# 1. Import data

**readr::read_csv** function:

* ~~keeps input types as is (no conversion to factor)~~ (since `R` 4.0.0)

* creates `tibbles` instead of `data.frame`
     - no names to rows
     - allows column names with special characters (see next slide)
     - more clever on screen display than w/ data.frames (see next slide)
     - [no partial matching on column names](https://stackoverflow.com/questions/58513997/how-to-make-r-stop-accepting-partial-matches-for-column-names)
     - warning if attempt to access unexisting column

* is daaaaaamn fast `r emo::ji("racing_car")`

---




---


# Tibbles

---




# Modules:

1. [Basics of R & RStudio](#module1)

<!-- 1. [Dynamic Documents using R Markdown](#module2) -->

1. .bg-yellow[[Data Visualisation using ggplot2](#module3)]

1. [Data Wrangling using dplyr](#module4)

<!-- 1. [Slide Crafting using xaringan](#module5) -->



---

name: module3

class: title-slide, center, middle, hide-count, hide-logo

background-image: url("https://images.unsplash.com/photo-1617164924207-40e6ee7c3ffe?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1740&q=80")
background-size: cover

# .white.big-text[Data Visualisation]
## .white[Session - 3]

.footnote[
.white[Image credits:][Kayvan Mazhar](https://unsplash.com/photos/SfxhjdST3Qs)
]

---


class: center

# Course Progress

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("images/data-science-communicate.png")
```

---

class: left, middle, hide-count, hide-logo

background-image: url("images/not_normal.png")
background-size: 70%
background-position: right

# .big-text[Data]

.footnote[
[Artwork Source](https://www.allisonhorst.com/)
]

---

# Variable types in R:

--

- `int` stands for integers, like 4, 55, 300.

--

- `dbl` stands for doubles, or real numbers like 3, 7.45, 1.565, 12.

--

- `chr` stands for character vectors, or strings like names.

--

- `dttm` stands for date-times (a date + a time).

--

- `lgl` stands for logical, vectors that contain only TRUE or FALSE.

--

- `fct` stands for factors, which R uses to represent **categorical variables** with fixed possible values like occupation: student, professional, government, business.

--

- `date` stands for dates.

---

class: hide-logo

background-image: url("images/culmen_depth.png")
background-size: 25%
background-position: 95% 5%

# Data of Palmer Penguins

- It comes with R package `palmerpenguins`

--

- Name of the data is `penguins`

--

- To know more about the data `?penguins`

--

- Included variables are:
  - `r names(penguins)`


.footnote[
[Artwork Source](https://www.allisonhorst.com/)
]


---

# An Overview of Data

.panelset[

.panel[.panel-name[Codes]

```{r glimp, eval=FALSE, echo=TRUE}
glimpse(penguins) #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="glimp", echo=FALSE}
```

]
]

---

### An Overview of Data

.panelset[

.panel[.panel-name[Codes]

```{r summ, eval=FALSE, echo=TRUE}
summary(penguins) #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="summ", echo=FALSE}
```

]
]


---

# Packages required: 

```{r pkgs, eval=FALSE, echo=TRUE}
library(palmerpenguins) # to access penguin data
library(tidyverse) # to use ggplot2 pkg
```

- Packages recommended:

```{r more-pkgs, eval=FALSE, echo=TRUE}
install.packages(c(
  "directlabels", "dplyr", "gameofthrones", "ggforce", "gghighlight", 
  "ggnewscale", "ggplot2", "ggraph", "ggrepel", "ggtext", "ggthemes", 
  "hexbin", "mapproj", "maps", "munsell", "ozmaps", "paletteer", 
  "patchwork", "rmapshaper", "scico", "seriation", "sf", "stars", 
  "tidygraph", "tidyr", "wesanderson" 
))
```

---

class: left, middle, hide-count, hide-logo

background-image: url("images/ggplot-logo.png")
background-size: contain
background-position: 100% 50%

# .big-text[R<br>Package]

---

# ggplot2 by [Hadley Wickham](http://hadley.nz/)
<br>
- "is a system for declaratively creating graphics, based on [The Grammar of Graphics](https://www.springer.com/gp/book/9780387245447)" (book by Late Leland Wilkinson)

.pull-left[
```{r wilkinson, echo=FALSE, out.width="40%", fig.cap="Late Leland Wilkinson"}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/en/b/b5/Leland_Wilkinson.png")
```
]

.pull-right[
```{r hadley, echo=FALSE, out.width="58%", fig.cap="Hadley Wickham"}
knitr::include_graphics("images/hadley.jpg")
```
]

.footnote[
[Source](https://ggplot2.tidyverse.org/)
]

---
class: hide-count, hide-logo

background-image: url("images/layer7.png")
background-size: contain
background-position: 50% 50%

.footnote[
[Source](https://www.ericchowkokyew.com/data-visualization-with-ggplot2-in-r/)
]

---

# Key Components for ggplot2 Plot

1. data,

1. aesthetic mapping

1. at least one layer of geom function

---

.panelset[

.panel[.panel-name[Task]

```{r layer11, echo=FALSE, out.width="45%"}
knitr::include_graphics("images/layer1.png")
```

]

.panel[.panel-name[Codes]

```{r imp-data1, eval=FALSE, echo=TRUE , echo=TRUE}
ggplot(data = penguins) #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="imp-data1", echo=FALSE}
```

]
]

---

.panelset[

.panel[.panel-name[Task]

```{r layer2, echo=FALSE, out.width="45%"}
knitr::include_graphics("images/layer2.png")
```

]

.panel[.panel-name[Codes]

```{r aes, eval=FALSE, echo=TRUE}
ggplot(data = penguins, mapping = aes(x = species)) #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="aes", echo=FALSE}
```

]
]

---

.panelset[

.panel[.panel-name[Task]

```{r layer3, echo=FALSE, out.width="45%"}
knitr::include_graphics("images/layer3.png")
```

]

.panel[.panel-name[Codes]

```{r geom-bar, eval=FALSE, echo=TRUE}
ggplot(data = penguins, mapping = aes(x = species)) +
  geom_bar() #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="geom-bar", echo=FALSE}
```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r geom-bar-pro, eval=FALSE, echo=TRUE}
ggplot(penguins, aes(x = species)) +
  geom_bar() 
```

]

.panel[.panel-name[Output]

```{r ref.label="geom-bar-pro", echo=FALSE}
```

]
]

---

class: your-turn, hide-logo

# `r emo::ji("brain")` YOUR TURN

```{r echo=FALSE}
countdown(minutes = 5, top = 0, font_size = "3em")
```

.panelset[

.panel[.panel-name[Output]

```{r ref.label="yt11", echo=FALSE, out.width="38%"}
```

]

.panel[.panel-name[Codes]

```{r yt11, eval=FALSE, echo=TRUE}
ggplot(data = penguins, mapping = aes(x = island)) +
  geom_bar() 
```

]
]

---

class: center, middle

# How to export plot to your computer?

---

.panelset[

.panel[.panel-name[Codes]

```{r export-plot, eval=FALSE, echo=TRUE}
ggplot(data = penguins, mapping = aes(x = species)) +
  geom_bar() 

ggsave("peng-species.pdf")  # also try jpg/jpeg/png #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="export-plot", echo=FALSE}

```

]
]

---
class: center, middle

# How to add color to bars?

---

.panelset[

.panel[.panel-name[Codes]

```{r color, eval=FALSE, echo=TRUE}
ggplot(data = penguins, mapping = aes(x = species)) +
  geom_bar(fill = "blue") #<<
```

]

.panel[.panel-name[Output]

```{r ref.label="color", echo=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r colors, eval=FALSE, echo=TRUE}
ggplot(data = penguins, mapping = aes(x = species)) +
  geom_bar(fill = c("orange", "white", "green")) #<<

# color names should be equal to the factor levels
# in case of factor species levels are three
# Adele, Chinstrap & Gentoo
```

]

.panel[.panel-name[Output]

```{r ref.label="colors", echo=FALSE}

```

]
]

---

class: center, middle

# How to add color using palette? `r emo::ji("art")`

---

## `r emo::ji("art")` Color Palette

- R package `RColorBrewer` & `wesanderson`

```{r fig.retina=3, fig.width=17, fig.height=15}
library(RColorBrewer)
display.brewer.all()
```

---

.panelset[

.panel[.panel-name[Codes]

```{r palette, eval=FALSE, echo=TRUE}
library(RColorBrewer)

ggplot(data = penguins,
       mapping = aes(x = species,
                     fill = species)) + #<<
  geom_bar() +
  scale_fill_brewer(palette = "Dark2") #<<

```

]

.panel[.panel-name[Output]

```{r ref.label="palette", echo=FALSE}

```

]
]

---

class: center, middle

# How to remove legend or change its position?


---

.panelset[

.panel[.panel-name[Codes]

```{r legend, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = species,
                     fill = species)) + 
  geom_bar() +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none") # top, bottom, left

```

]

.panel[.panel-name[Output]

```{r ref.label="legend", echo=FALSE}

```

]
]

---

class: center, middle

# How to plot title and axis titles?

---

.panelset[

.panel[.panel-name[Codes]

```{r labs, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = species,
                     fill = species)) +
  geom_bar() +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none") +
  labs(
    title = "Species of palmer penguins",
    subtitle = "This data is about penguins",
    x = "Species",
    y = "Frequency"
  )

```

]

.panel[.panel-name[Output]

```{r ref.label="labs", echo=FALSE}

```

]
]

---

class: center, middle

# How to control size of text?

---

.panelset[

.panel[.panel-name[Codes]

```{r size, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = species,
                     fill = species)) +
  geom_bar() +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none",
        text = element_text(size = 20)) + #<<
  labs(
    title = "Species of palmer penguins",
    subtitle = "This data is about penguins",
    x = "Species",
    y = "Frequency"
  )

```

]

.panel[.panel-name[Output]

```{r ref.label="size", echo=FALSE}

```

]
]

---

class: center, middle

# How to plot two numeric variables?

---

.panelset[

.panel[.panel-name[Codes]

```{r num, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = bill_length_mm,
                     y = bill_depth_mm,
                     color = species)) +
  geom_point() +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none",
        text = element_text(size = 20)) + #<<
  labs(
    title = "Relationship between bill length \n& depth of palmer penguins",
    subtitle = "This data is about penguins",
    x = "Bill length (mm)",
    y = "Bith depth (mm)"
  )

```

]

.panel[.panel-name[Output]

```{r ref.label="num", echo=FALSE, warning=FALSE}

```

]
]

---

class: center, middle

# How to add themes to ggplot?

---

# ggplot2 themes 

<https://ggplot2.tidyverse.org/reference/ggtheme.html>

- theme_gray()

- theme_bw()

- theme_linedraw()

- theme_light()

- theme_dark()

- theme_minimal()

- theme_classic()

- theme_void()

- theme_test()

---

.panelset[

.panel[.panel-name[Codes]

```{r theme1, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = bill_length_mm,
                     y = bill_depth_mm,
                     color = species)) +
  geom_point() +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none",
        text = element_text(size = 20)) + 
  labs(
    title = "Relationship between bill length \n& depth of palmer penguins",
    subtitle = "This data is about penguins",
    x = "Bill length (mm)",
    y = "Bith depth (mm)"
  ) +
  theme_bw() #<<

```

]

.panel[.panel-name[Output]

```{r ref.label="theme1", echo=FALSE, warning=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r theme2, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = bill_length_mm,
                     y = bill_depth_mm,
                     color = species)) +
  geom_point() +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none",
        text = element_text(size = 20)) + #<<
  labs(
    title = "Relationship between bill length \n& depth of palmer penguins",
    subtitle = "This data is about penguins",
    x = "Bill length (mm)",
    y = "Bith depth (mm)"
  ) +
  theme_classic()

```

]

.panel[.panel-name[Output]

```{r ref.label="theme2", echo=FALSE, warning=FALSE}

```

]
]

---

class: center, middle

# How to add regression line to ggplot?

---

.panelset[

.panel[.panel-name[Codes]

```{r reg, eval=FALSE, echo=TRUE}
ggplot(data = penguins,
       mapping = aes(x = flipper_length_mm,
                     y = body_mass_g)) +
  geom_point() +
  theme(legend.position = "none",
        text = element_text(size = 24)) + 
  labs(
    title = "Relationship between bill length \n& depth of palmer penguins",
    subtitle = "This data is about penguins",
    x = "Flipper length (mm)",
    y = "Body mass (gm)"
  ) +
  theme_classic() +
  geom_smooth() #<<

```

]

.panel[.panel-name[Output]

```{r ref.label="reg", echo=FALSE, warning=FALSE, message=FALSE}

```

]
]

---

# More resources

- ggplot2 book https://ggplot2-book.org/

- CÉDRIC SCHERER https://www.cedricscherer.com/

- ggplot2 cook book http://www.cookbook-r.com/

---

class: center middle hide-count

#  `r emo::ji("woman_raising_hand_medium_skin_tone")``r emo::ji("man_raising_hand")`<br>.big-text[Q&A]

---

class: center, middle, inverse

# Dynamic Wrangling<br>Using dplyr
### .orange[Next Module - 4]

---

---

class: center, middle, inverse

# Dynamic Wrangling<br>Using dplyr
### .orange[Next Module - 4]

---

# Modules:

1. [Basics of R & RStudio](#module1)

1. [Dynamic Documents using R Markdown](#module2)

1. [Data Visualisation using ggplot2](#module3)

1. .b[[Data Wrangling using dplyr](#module4)]

1. [Slide Crafting using xaringan](#module5)

---

name: module4

class: title-slide, right, middle, hide-count, hide-logo

background-image: url("https://images.unsplash.com/photo-1591903934817-c02acbfd4665?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1932&q=80")
background-size: cover

<br>
<br>
<br>
<br>

# .black.big-text[Data<br>Wrangling]
## .black[Session - 4]

.footnote[
.white[Image credits:][Karina L](https://unsplash.com/photos/zJRQ5nngdPA)
]

---

class: hide-logo, center

<iframe width="960" height="615" src="https://www.youtube.com/embed/QGj8hEcDW0E" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

---

class: center

# Course Progress

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("images/data-science-wrangle.png")
```

---

# What is Data wrangling?

--

- "data exploration and data manipulation" [(Jesse Mostipak)](https://www.kaggle.com/jessemostipak/dive-into-dplyr-tutorial-1)

--

- "tidying and transforming" [(Hadley & Garrett)](https://r4ds.had.co.nz/index.html)

--

```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("images/tidy-1.png")
```

---

# "Transforming" data means:

- "narrowing in on observations of interest ... 

--

- creating new variables that are functions of existing variables ... and

--

- calculating a set of summary statistics." 

.footnote[[Source](https://r4ds.had.co.nz/index.html)]

---

class: hide-count, middle, hide-logo
background-image: url(images/dplyr.svg)
background-size: contain
background-position: right

# .big-text[R<br>Package]

---

# `dplyr` package

- "dplyr is a grammar of data manipulation"

--

- "providing a consistent set of verbs that help you solve the most common data manipulation challenges:"

--

- Few important functions:
  - `filter()` 
  - `select()` 
  - `mutate()` 
  - `arrange()` 
  - `summarise()`

.footnote[
[Source](https://dplyr.tidyverse.org/)
]

---

# `filter()` function: 

- Picks cases based on their values.

```{r filter-img, echo=FALSE, fig.align='center', out.width="65%"}
knitr::include_graphics("images/01-filter.png")
```

---

class: center, middle 

# How to have a data of only Gentoo penguins?

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-fun, eval=FALSE, echo=TRUE}
# there are three species: Chinstrap, Gentoo, Adelie
penguins %>% 
  filter(species == "Gentoo") #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-summ, eval=FALSE, echo=TRUE}
# there are three species: Chinstrap, Gentoo, Adelie

praw <- read_csv("data/gentoo-penguins1.csv")

praw %>% 
  filter(species == "Gentoo") %>% 
  summary() %>% 
  kableExtra::kable()
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-summ", echo=FALSE, message=FALSE}

```

]
]

---

class: center, middle

# How to export data file to your computer?

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-fun1, eval=FALSE, echo=TRUE}
# three species are Chinstrap, Gentoo, Adelie
penguins %>% 
  filter(species == "Gentoo") %>% 
  write_csv("data/gentoo-penguins.csv") #<<

```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun1", echo=FALSE, message=FALSE}

```

]
]

---

# `r emo::ji("raised_hand")` WAIT! What is `%>% `

--

- this is called **pipe** ( `%>%` = control + shift + m)

--

- "a powerful tool for clearly expressing a sequence of **multiple operations**"

--

- interpret/read it as **then**.

```{r echo=T, eval=FALSE}
penguins %>% 
  filter(species == "Gentoo") %>% 
  summary() %>% 
  kableExtra::kable()
```

---

# Comparison: Relational Operators

`x < y`

--

`x > y`

--

`x <= y`

--

`x >= y`

--

`x == y` (equal)

--

`x != y` (not equal)

---
class: center, middle 

# How to have a data of penguins with bill length more than 43 mm?

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-fun2, eval=FALSE, echo=TRUE}
penguins %>% 
  filter(bill_length_mm > 43) 
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun2", echo=FALSE, message=FALSE}

```

]
]

---
class: center, middle 

# How to have a data of Gentoo penguins with bill length more than 50 mm?

---
.panelset[

.panel[.panel-name[Codes]

```{r filter-fun3, eval=FALSE, echo=TRUE}
penguins %>% 
  filter(species == "Gentoo",
         bill_length_mm > 55)
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun3", echo=FALSE, message=FALSE}

```

]
]

---
class: center, middle 

# How to have data of non-Gentoo penguins with bill length more than 45 mm and weight more than 4 kg?

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-fun4, eval=FALSE, echo=TRUE}
penguins %>% 
  filter(species != "Gentoo",
         bill_length_mm > 45,
         body_mass_g > 4000)
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun4", echo=FALSE, message=FALSE}

```

]
]

---
class: center, middle

# How to have only top or bottom rows from data?

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-fun41, eval=FALSE, echo=TRUE}
penguins %>% 
  filter(species != "Gentoo",
         bill_length_mm > 45,
         body_mass_g > 4000) %>% 
  head() #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun41", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r filter-fun42, eval=FALSE, echo=TRUE}
penguins %>% 
  filter(species != "Gentoo",
         bill_length_mm > 45,
         body_mass_g > 4000) %>% 
  tail(3) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="filter-fun42", echo=FALSE, message=FALSE}

```

]
]

---

class: your-turn, hide-logo

# `r emo::ji("brain")` YOUR TURN


```{r echo=FALSE}
countdown(minutes = 10, top = 0, font_size = "3em")
```

.panelset[

.panel[.panel-name[Task]

How many Chinstrap penguins are with bill length more than 45 mm and weight more than 4 kg?
]

.panel[.panel-name[Codes]

```{r yt1, eval=FALSE, echo=TRUE}
penguins %>% 
  filter(species == "Chinstrap",
         bill_length_mm > 45,
         body_mass_g > 4000) %>% 
  head()
```

]

.panel[.panel-name[Output]

```{r ref.label="yt1", echo=FALSE, message=FALSE}

```

]
]

---

# `select()` function: Chooses rows based on column values.

```{r select-img, echo=FALSE, fig.align='center', out.width="60%"}
knitr::include_graphics("images/03-select.png")
```

---
class: center, middle

# How to have only `species` variable in data?

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun1, eval=FALSE, echo=TRUE}
penguins %>% 
  select(species) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun1", echo=FALSE, message=FALSE}

```

]
]

---
class: center, middle

# How to have a specific range of variables in data?

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun2, eval=FALSE, echo=TRUE}
penguins %>% 
  select(species : bill_depth_mm)
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun2", echo=FALSE, message=FALSE}

```

]
]

---
class: center, middle

# How to have variables based upon their location in data?

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun3, eval=FALSE, echo=TRUE}
penguins %>% 
  select(4:8)
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun3", echo=FALSE, message=FALSE}

```

]
]

---
class: center, middle

# How to have specific variables in data?

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun4, eval=FALSE, echo=TRUE}
penguins %>% 
  select(species, body_mass_g, year)
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun4", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun5, eval=FALSE, echo=TRUE}
penguins %>% 
  select(-c(species, body_mass_g, year))
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun5", echo=FALSE, message=FALSE}

```

]
]

---

# `mutate()` function: Adds new variables that are functions of existing variables

```{r mutate-img, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("images/04-mutate.png")
```

---

class: center, middle

# How to convert penguin body mass from grams to kilograms?

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun7, eval=FALSE, echo=TRUE}
penguins %>% 
  mutate(body_mass_kg = body_mass_g / 1000) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun7", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun77, eval=FALSE, echo=TRUE}
penguins %>% 
  select(body_mass_g) %>%
  mutate(body_mass_kg = body_mass_g / 1000)
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun77", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun8, eval=FALSE, echo=TRUE}
penguins %>% 
  mutate(body_mass_kg = body_mass_g / 1000, 
         bill = bill_length_mm * bill_depth_mm)
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun8", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r col-fun81, eval=FALSE, echo=TRUE}
penguins %>% 
  mutate(body_mass_kg = body_mass_g / 1000,
         bill = bill_length_mm * bill_depth_mm) %>% 
  select(body_mass_kg,
         bill)
```
]

.panel[.panel-name[Output]

```{r ref.label="col-fun81", echo=FALSE, message=FALSE}

```

]
]

---

# `arrange()` function: Changes the order of the rows.

```{r arrange-img, echo=FALSE, fig.align='center', out.width="65%"}
knitr::include_graphics("images/02-arrange.png")
```

---

class: center, middle

# How to have data arranged by the ascending order of bill length of penguins?

---

.panelset[

.panel[.panel-name[Codes]

```{r arg-fun, eval=FALSE, echo=TRUE}
penguins %>% 
  arrange(bill_length_mm) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="arg-fun", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r arg-fun2, eval=FALSE, echo=TRUE}
penguins %>% 
  arrange(desc(bill_length_mm)) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="arg-fun2", echo=FALSE, message=FALSE}

```

]
]

---

.panelset[

.panel[.panel-name[Codes]

```{r arg-fun3, eval=FALSE, echo=TRUE}
penguins %>% 
  arrange(species)
```
]

.panel[.panel-name[Output]

```{r ref.label="arg-fun3", echo=FALSE, message=FALSE}

```

]
]

---

class: center, middle, inverse

# `summarise()` function

---

# `summarise()` function: Chooses rows based on column values.

```{r summ-img, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("images/05-summarise.png")
```

---

class: center, middle

# How to find mean bill length of all penguins?

---

.panelset[

.panel[.panel-name[Codes]

```{r summ-fun1, eval=FALSE, echo=TRUE}
penguins %>% 
  drop_na() %>% #<<
  summarise(mean_bill_length_mm = mean(bill_length_mm)) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="summ-fun1", echo=FALSE, message=FALSE}

```

]
]

---

class: center, middle

# How to find species-wise mean bill length of penguins?

---

.panelset[

.panel[.panel-name[Codes]

```{r summ-fun2, eval=FALSE, echo=TRUE}
penguins %>% 
  drop_na() %>% #<<
  group_by(species) %>% #<<
  summarise(mean_bill_length_mm = mean(bill_length_mm))
```
]

.panel[.panel-name[Output]

```{r ref.label="summ-fun2", echo=FALSE, message=FALSE}

```

]
]

---

class: center, middle

# How to find species-wise mean bill length of penguins and total number of penguins in each species?

---

.panelset[

.panel[.panel-name[Codes]

```{r summ-fun21, eval=FALSE, echo=TRUE}
penguins %>% 
  drop_na() %>% 
  group_by(species) %>% 
  summarise(mean_bill_length_mm = mean(bill_length_mm), n = n()) #<<
```
]

.panel[.panel-name[Output]

```{r ref.label="summ-fun21", echo=FALSE, message=FALSE}

```

]
]

---

class: center middle hide-count

#  `r emo::ji("woman_raising_hand_medium_skin_tone")``r emo::ji("man_raising_hand")`<br>.big-text[Q&A]

---

class: center, middle, inverse

# Slide Crafting<br>using xaringan
### .orange[Next Module - 5]

---











